<?xml version="1.0" encoding="UTF-8"?>
<blueprint xmlns="http://www.osgi.org/xmlns/blueprint/v1.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
           xmlns:jaxrs="http://cxf.apache.org/blueprint/jaxrs" xmlns:cxf="http://cxf.apache.org/blueprint/core"
           xsi:schemaLocation="http://www.osgi.org/xmlns/blueprint/v1.0.0 http://www.osgi.org/xmlns/blueprint/v1.0.0/blueprint.xsd
             http://cxf.apache.org/blueprint/jaxrs http://cxf.apache.org/schemas/blueprint/jaxrs.xsd
             http://cxf.apache.org/blueprint/core http://cxf.apache.org/schemas/blueprint/core.xsd">

    <!-- ################### Internal Services Expose ####################### -->
    <service interface="de.soco.software.simuspace.suscore.data.manager.base.ClickManager" ref="wizardsManager">
    </service>


    <!-- ######################## External Services Imports ############################ -->

    <reference id="licenseManager" interface="de.soco.software.simuspace.suscore.license.manager.LicenseManager"/>
    <reference interface="de.soco.software.simuspace.suscore.object.manager.SuSObjectTreeManager" id="treeManager"/>
    <reference id="permissionManager"
               interface="de.soco.software.simuspace.suscore.permissions.manager.PermissionManager"/>
    <reference id="workflowManager" interface="de.soco.software.simuspace.server.manager.WorkflowManager"/>
    <reference interface="de.soco.software.simuspace.suscore.object.manager.DataManager" id="dataManager"/>
    <reference interface="de.soco.software.simuspace.suscore.object.manager.DataObjectManager" id="dataObjectManager"/>
    <reference interface="de.soco.software.simuspace.suscore.object.manager.DataProjectManager" id="dataProjectManager"/>
    <reference interface="de.soco.software.simuspace.suscore.core.manager.SelectionManager" id="selectionManager"/>
    <reference id="susDAO" interface="de.soco.software.simuspace.suscore.data.common.dao.SuSGenericObjectDAO"/>
    <reference id="locationManager" interface="de.soco.software.simuspace.suscore.location.manager.LocationManager"/>
    <reference id="jobManager" interface="de.soco.software.simuspace.server.manager.JobManager"/>
    <reference id="relationDAO" interface="de.soco.software.simuspace.suscore.data.common.dao.ContextMenuRelationDAO"/>
    <reference id="linkDao" interface="de.soco.software.simuspace.suscore.core.dao.LinkDAO"/>

    <reference id="objectViewManager"
               interface="de.soco.software.simuspace.suscore.data.manager.base.ObjectViewManager"/>

    <reference id="userCommonManager"
               interface="de.soco.software.simuspace.suscore.data.manager.base.UserCommonManager"/>
    <reference id="userManager" interface="de.soco.software.simuspace.suscore.user.manager.UserManager"/>
    <reference id="contextMenuManager"
               interface="de.soco.software.simuspace.suscore.data.manager.base.ContextMenuManager"/>
    <reference id="objectTypeConfigCacheManager"
               interface="de.soco.software.simuspace.suscore.lifecycle.manager.ObjectTypeConfigManager"/>

    <reference id="threadPoolExecutorService"
               interface="de.soco.software.simuspace.suscore.executor.service.ThreadPoolExecutorService"/>

    <reference id="submitLoadcaseDAO" interface="de.soco.software.simuspace.suscore.object.dao.SubmitLoadcaseDAO"/>


    <reference id="bmwCaeBenchDAO" interface="de.soco.software.simuspace.suscore.data.common.dao.BmwCaeBenchDAO"/>

    <reference id="bmwCaeBenchNodeDAO"
               interface="de.soco.software.simuspace.suscore.data.common.dao.BmwCaeBenchNodeDAO"/>

    <reference id="tokenManager" interface="de.soco.software.simuspace.suscore.interceptors.manager.UserTokenManager"/>

    <reference id="authManager" interface="de.soco.software.simuspace.suscore.authentication.manager.AuthManager"/>

    <reference id="entityManagerFactory" interface="javax.persistence.EntityManagerFactory"/>

    <!-- ############################################# Suscore BUS ############################################# -->

    <cxf:bus id="suscore_bus">
        <cxf:inInterceptors>
            <ref component-id="susLoggingInInterceptor"/>
        </cxf:inInterceptors>
        <cxf:outInterceptors>
            <ref component-id="susLoggingOutInterceptor"/>
        </cxf:outInterceptors>
    </cxf:bus>


    <!-- ############################################# Services Exports ############################################# -->

    <!-- ############################################# Jax RS Server ############################################# -->

    <jaxrs:server id="treeService" address="/wizards">
        <jaxrs:serviceBeans>
            <ref component-id="wizardsServiceBean"/>
        </jaxrs:serviceBeans>
        <jaxrs:providers>
            <ref component-id="jsonProvider"/>
        </jaxrs:providers>
    </jaxrs:server>

    <jaxrs:server id="LCService" address="/config">
        <jaxrs:serviceBeans>
            <ref component-id="loadcaseServiceBean"/>
        </jaxrs:serviceBeans>
        <jaxrs:providers>
            <ref component-id="jsonProvider"/>
        </jaxrs:providers>
    </jaxrs:server>

    <jaxrs:server id="externalSelectionWorkflowService" address="/external">
        <jaxrs:serviceBeans>
            <ref component-id="externalSelectionServiceBean"/>
        </jaxrs:serviceBeans>
        <jaxrs:providers>
            <ref component-id="jsonProvider"/>
        </jaxrs:providers>
    </jaxrs:server>

    <jaxrs:server id="qaDynaService" address="/qadyna">
        <jaxrs:serviceBeans>
            <ref component-id="qaDynaServiceBean"/>
        </jaxrs:serviceBeans>
        <jaxrs:providers>
            <ref component-id="jsonProvider"/>
        </jaxrs:providers>
    </jaxrs:server>


    <!-- ############################################# Beans ############################################# -->

    <bean id="jsonProvider" class="com.fasterxml.jackson.jaxrs.json.JacksonJsonProvider"/>


    <bean id="susLoggingInInterceptor" class="de.soco.software.simuspace.suscore.interceptors.SusLoggingInInterceptor"/>

    <bean id="susLoggingOutInterceptor"
          class="de.soco.software.simuspace.suscore.interceptors.SusLoggingOutInterceptor"/>
    <bean id="wizardsServiceBean" class="de.soco.software.simuspace.wizards.service.rest.impl.WizardsServiceImpl">
        <property name="wizardsManager" ref="wizardsManager"/>
        <property name="cb2DummyManager" ref="cb2DummyManager"/>
        <property name="loadcaseManager" ref="loadcaseManager"/>
    </bean>

    <bean id="externalSelectionServiceBean"
          class="de.soco.software.simuspace.wizards.service.rest.impl.ExternalServiceImpl">
        <property name="selectionManager" ref="selectionManager"/>
        <property name="treeManager" ref="treeManager"/>
        <property name="wizardsManager" ref="wizardsManager"/>
        <property name="loadcaseManager" ref="loadcaseManager"/>
    </bean>

	<bean id="qaDynaServiceBean"
          class="de.soco.software.simuspace.wizards.service.rest.impl.QaDynaServiceImpl">
        <property name="qaDynaManager" ref="qaDynaManager"/>
    </bean>

    <bean id="qaDynaManager" class="de.soco.software.simuspace.wizards.manager.impl.QaDynaManagerImpl">
        <property name="susDAO" ref="susDAO"/>
        <property name="authManager" ref="authManager"/>
        <property name="entityManagerFactory" ref="entityManagerFactory"/>
        <property name="selectionManager" ref="selectionManager"/>
        <property name="bmwCaeBenchDAO" ref="bmwCaeBenchDAO"/>
        <property name="qaDynaDAO" ref="qaDynaDAO"/>
        <property name="dataProjectManager" ref="dataProjectManager"/>
        <property name="userCommonManager" ref="userCommonManager"/>
        <property name="locationManager" ref="locationManager"/>
        <property name="jobManager" ref="jobManager"/>
        <property name="wizardsManager" ref="wizardsManager"/>
        <property name="workflowManager" ref="workflowManager"/>
        <property name="licenseManager" ref="licenseManager"/>
    </bean>


    <bean id="dummyTypeDAO" class="de.soco.software.simuspace.wizards.dao.impl.DummyTypeDAOImpl">
    </bean>


    <bean id="wizDAO" class="de.soco.software.simuspace.wizards.dao.impl.WizDAOImpl">
    </bean>
    <bean id="loadcaseWizDAO" class="de.soco.software.simuspace.wizards.dao.impl.LoadcaseWizDAOImpl">
    </bean>
    <bean id="loadCaseDAO" class="de.soco.software.simuspace.wizards.dao.impl.LoadCaseDAOImpl">
    </bean>
    <bean id="qaDynaDAO" class="de.soco.software.simuspace.wizards.dao.impl.QADynaDAOImpl">
    </bean>


    <bean id="wizardsManager" class="de.soco.software.simuspace.wizards.manager.impl.WizardsManagerImpl"
          init-method="init">
        <property name="treeManager" ref="treeManager"/>
        <property name="dataObjectManager" ref="dataObjectManager"/>
        <property name="susDAO" ref="susDAO"/>
        <property name="wizDAO" ref="wizDAO"/>
        <property name="linkDao" ref="linkDao"/>
        <property name="loadcaseWizDAO" ref="loadcaseWizDAO"/>
        <property name="loadCaseDAO" ref="loadCaseDAO"/>
        <property name="selectionManager" ref="selectionManager"/>
        <property name="loadcaseManager" ref="loadcaseManager"/>
        <property name="workflowManager" ref="workflowManager"/>
        <property name="permissionManager" ref="permissionManager"/>
        <property name="locationManager" ref="locationManager"/>
        <property name="jobManager" ref="jobManager"/>
        <property name="relationDAO" ref="relationDAO"/>
        <property name="relationDAO" ref="relationDAO"/>
        <property name="cb2DummyManager" ref="cb2DummyManager"/>
        <property name="objectViewManager" ref="objectViewManager"/>
        <property name="licenseManager" ref="licenseManager"/>
        <property name="dummyTypeDAO" ref="dummyTypeDAO"/>
        <property name="configManager" ref="objectTypeConfigCacheManager"/>
        <property name="userCommonManager" ref="userCommonManager"/>
        <property name="submitLoadcaseDAO" ref="submitLoadcaseDAO"/>
        <property name="bmwCaeBenchDAO" ref="bmwCaeBenchDAO"/>
        <property name="bmwCaeBenchNodeDAO" ref="bmwCaeBenchNodeDAO"/>
        <property name="authManager" ref="authManager"/>
        <property name="entityManagerFactory" ref="entityManagerFactory"/>
        <property name="tokenManager" ref="tokenManager"/>

    </bean>


    <bean id="cb2DummyManager" class="de.soco.software.simuspace.wizards.manager.impl.Cb2DummyManagerImpl">
    </bean>

    <bean id="loadcaseServiceBean" class="de.soco.software.simuspace.wizards.service.rest.impl.LoadcaseServiceImpl">
        <property name="loadcaseManager" ref="loadcaseManager"/>
    </bean>

    <bean id="loadcaseManager" class="de.soco.software.simuspace.wizards.manager.impl.LoadcaseManagerImpl">
        <property name="susDAO" ref="susDAO"/>
        <property name="loadcaseWizDAO" ref="loadcaseWizDAO"/>
        <property name="objectViewManager" ref="objectViewManager"/>
        <property name="userCommonManager" ref="userCommonManager"/>
        <property name="userManager" ref="userManager"/>
        <property name="selectionManager" ref="selectionManager"/>
        <property name="permissionManager" ref="permissionManager"/>
        <property name="jobManager" ref="jobManager"/>
        <property name="locationManager" ref="locationManager"/>
        <property name="threadPoolExecutorService" ref="threadPoolExecutorService"/>
        <property name="dummyTypeDAO" ref="dummyTypeDAO"/>
        <property name="entityManagerFactory" ref="entityManagerFactory"/>
    </bean>

</blueprint>